{"componentChunkName":"component---src-templates-blog-tsx","path":"/blog/20170509-release-deepstream-2.3/","webpackCompilationHash":"0f3352f8274dbe1392d8","result":{"data":{"markdownRemark":{"html":"<p>We are super excited to announce the release of <a href=\"https://github.com/deepstreamIO/deepstream.io/releases/tag/v2.3.2\">deepstream.io 2.3</a>! It contains quite a few radical improvements that are aimed to provide developers the tools to cater for more complex use cases.</p>\n<p>Here are some of the highlights:</p>\n<ul>\n<li><a href=\"#setting-data\">Pure Publishers:</a> allowing providers to insert data without needing to subscribe.</li>\n<li><a href=\"#hot-paths\">Hot Paths:</a> allow deepstream to supercharge trusted records by bypassing validation.</li>\n<li><a href=\"#performance-improvements\">Performance Improvements:</a> even more performance improvements!</li>\n<li><a href=\"#generic-plugins\">Generic Plugins:</a> add any type of plugin into the deepstream.io ecosystem, allowing you to augment workflows and switch out subsystems.</li>\n<li><a href=\"#connection-endpoints\">Connection Endpoints:</a> give you the tools to implement your favourite transport layer or realtime protocol, or go wild and write one from scratch.</li>\n</ul>\n<div>\n  \n  <a class=\"gatsby-resp-image-link\" href=\"/static/f53fbdc866a7dc558f709f63c9d3c1c8/67d4f/2.3-deepstream.io.jpg\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n  \n  <span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block;  max-width: 700px; margin-left: auto; margin-right: auto;\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 57.14285714285714%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAgAD/8QAFgEBAQEAAAAAAAAAAAAAAAAABAEC/9oADAMBAAIQAxAAAAHJ4tgXC1P/xAAZEAADAAMAAAAAAAAAAAAAAAABEBECEiH/2gAIAQEAAQUCnINMgFV//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAGBAAAgMAAAAAAAAAAAAAAAAAAAEgIVH/2gAIAQEABj8CFpUP/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERITFRcf/aAAgBAQABPyFWOcHIJ7sUa3V+jbySXWS+s//aAAwDAQACAAMAAAAQLB//xAAWEQEBAQAAAAAAAAAAAAAAAAABAFH/2gAIAQMBAT8QUyUb/8QAFhEBAQEAAAAAAAAAAAAAAAAAAQBR/9oACAECAQE/EAdgS//EABoQAQADAQEBAAAAAAAAAAAAAAEAETEhQfH/2gAIAQEAAT8QZ71uE1gKl4ecrZZNCXTXoyAUIHS4UhyM6z70/9k=&apos;); background-size: cover; display: block;\">\n      <img class=\"gatsby-resp-image-image\" style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\" alt=\"deepstream.io 2.3\" title src=\"/static/f53fbdc866a7dc558f709f63c9d3c1c8/67d4f/2.3-deepstream.io.jpg\" srcset=\"/static/f53fbdc866a7dc558f709f63c9d3c1c8/458aa/2.3-deepstream.io.jpg 210w,\n/static/f53fbdc866a7dc558f709f63c9d3c1c8/3616f/2.3-deepstream.io.jpg 420w,\n/static/f53fbdc866a7dc558f709f63c9d3c1c8/67d4f/2.3-deepstream.io.jpg 700w\" sizes=\"(max-width: 700px) 100vw, 700px\">\n    </span>\n  </span>\n  \n  </a>\n    \n</div>\n<h2 id=\"setting-data\"><a href=\"#setting-data\" aria-label=\"setting data permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Setting Data</h2>\n<p>Built to be an extremely fast realtime server, deepstream allows users to collaborate on shared objects and aims to synchronise state between them in microseconds. The realtime protocol supports object deltas and active publishing paradigms to help you squeeze as much relevant data into a system as possible, while maintaining consistency.</p>\n<p>However, one pattern we realised occurs more often than not is where a single provider is really active, sending updates to tens of thousands of unique records a second, without ever really needing to subscribe to any of them.</p>\n<p>Because of this we are proud to announce the new <code class=\"language-text\">setData</code> API in all of our clients and server. It allows providers and publishers to update deepstream with the classical performance benefits of bulk insertions, without losing any of the realtime benefits of notifying all users!</p>\n<p>Using the old publisher approach, publishers would have to retrieve each record they wanted to write to:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> record <span class=\"token operator\">=</span> client<span class=\"token punctuation\">.</span>record<span class=\"token punctuation\">.</span><span class=\"token function\">getRecord</span><span class=\"token punctuation\">(</span><span class=\"token string\">'releases/2.2'</span><span class=\"token punctuation\">)</span>\nrecord<span class=\"token punctuation\">.</span><span class=\"token function\">whenReady</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">record</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  record<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">{</span>\n      releaseVersion<span class=\"token punctuation\">:</span> <span class=\"token string\">'2.2'</span><span class=\"token punctuation\">,</span>\n      type<span class=\"token punctuation\">:</span> <span class=\"token string\">'awesome'</span>\n  \t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'pre version 2.3'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span>\n  record<span class=\"token punctuation\">.</span><span class=\"token function\">discard</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>’</code></pre></div>\n<p>Now publishers can set data directly on the record:</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">client<span class=\"token punctuation\">.</span>record<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'releases/2.3'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n\treleaseVersion<span class=\"token punctuation\">:</span> <span class=\"token string\">'2.3'</span><span class=\"token punctuation\">,</span>\n\ttype<span class=\"token punctuation\">:</span> <span class=\"token string\">'more awesome'</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token parameter\">error</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'2.3 released!'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span></code></pre></div>\n<h2 id=\"hot-paths\"><a href=\"#hot-paths\" aria-label=\"hot paths permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Hot Paths</h2>\n<p>We took <code class=\"language-text\">setData</code> one step further by allowing administrators to specify an optional list of record prefixes to indicate records that have no possibility of version conflicts. By doing so, we are able to bypass loading the records previous state for version validation, and by no longer relying on the records previous state or payload validation, we can now improve performance over <em>20-fold</em> from the approaches used prior to this release.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">storageHotPathPatterns</span><span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">-</span> analytics/\n  <span class=\"token punctuation\">-</span> metrics/</code></pre></div>\n<h2 id=\"performance-improvements\"><a href=\"#performance-improvements\" aria-label=\"performance improvements permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Performance Improvements</h2>\n<p>Since we were already embarked on a performance-driven voyage, we decided to see how much further we could get. We profiled deepstream continuously to see what the biggest gains were. Most of the changes were purely micro optimizations, but we significantly reduced the possibility of CPU reaching 100%, helping prevent the server from creating a large backlog or introducing delays.</p>\n<p>The largest improvement however was allowing us to patch non critical updates, such as subscription acknowledgements and errors. By doing so, we reduced socket writes by almost 50% for subscription paths!</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token comment\"># The amount of milliseconds before flushing non critical writes</span>\n<span class=\"token key atrule\">outgoingBufferTimeout</span><span class=\"token punctuation\">:</span> <span class=\"token number\">20</span></code></pre></div>\n<h2 id=\"generic-plugins\"><a href=\"#generic-plugins\" aria-label=\"generic plugins permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Generic Plugins</h2>\n<p>The core of deepstream has always been based on freedom of choice. You can plug and play your own selection of cache, storage, message bus, logger, authentication handler and permission plugins (talk about flexibility!) to best suit your needs and comfort. But we often ask ourselves, is that truly enough? Wouldn’t it be awesome if you had the ability to:</p>\n<ul>\n<li>pick between having centralised or decentralised cluster state</li>\n<li>spin up an http server that would allow you to kick out users or dynamically update permissions</li>\n<li>gain insights into all sorts of usage metrics</li>\n<li>register your own extensions to the deepstream protocol</li>\n</ul>\n<p>While not all of the above are available right now, we have made huge head way in allowing you to inject any sort of plugin into deepstream. This allows you to load your plugins using the flexible plugin loading interface used for all our core plugins.</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">plugins</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">permission-reloader</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> deepstream.io<span class=\"token punctuation\">-</span>permission<span class=\"token punctuation\">-</span>reloader\n    <span class=\"token key atrule\">options</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> <span class=\"token number\">9090</span></code></pre></div>\n<h2 id=\"connection-endpoints\"><a href=\"#connection-endpoints\" aria-label=\"connection endpoints permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Connection Endpoints</h2>\n<p>Last but certainly not least, we have removed our direct dependency on websockets as a networking layer. This is the first step in allowing users to decide on different transmission protocols such as directly using tcp or udp, or different networking protocols such as http, engine.io, mqtt or maybe even radio waves for intense IoT devices!</p>\n<p>To do so we have improved the distinction between the core logic and networking layers. Although we currently allow a single connection endpoint per server, you can cluster servers to mix and match all your different endpoints to allow all your different devices to communicate as a swarm!</p>\n<div class=\"gatsby-highlight\" data-language=\"yaml\"><pre class=\"language-yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">connectionEndpoints</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">websocket</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> uws\n    <span class=\"token key atrule\">options</span><span class=\"token punctuation\">:</span>\n        <span class=\"token comment\"># port for the websocket server</span>\n        <span class=\"token key atrule\">port</span><span class=\"token punctuation\">:</span> <span class=\"token number\">6020</span>\n        <span class=\"token comment\"># host for the websocket server</span>\n        <span class=\"token key atrule\">host</span><span class=\"token punctuation\">:</span> 0.0.0.0</code></pre></div>","frontmatter":{"title":"Release: Deepstream 2.3","description":"Announcing the 2.3 release of deepstream.io and all the associated goodies"},"fields":{"slug":"/blog/20170509-release-deepstream-2.3/","githubLink":"https://github.com/deepstreamIO/deepstream.io-website/blob/master/content/blog/20170509-release-deepstream-2.3/index.md","weightedSlug":"/blog/20170509-release-deepstream-2.3/"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"slug":"/blog/20170509-release-deepstream-2.3/","navigation":{"order":100,"release-deepstream-2.3":{"slug":"/blog/20170509-release-deepstream-2.3/","title":"Release: Deepstream 2.3","description":"Announcing the 2.3 release of deepstream.io and all the associated goodies","leaf":true,"order":20170509,"":{"order":100}},"release-deepstream-2.4":{"slug":"/blog/20170702-release-deepstream-2.4/","title":"Release: Deepstream 2.4","description":"Announcing the 2.4 release of deepstream.io","leaf":true,"order":20170702,"":{"order":100}},"release-deepstream-3.0":{"slug":"/blog/20170721-release-deepstream-3.0/","title":"Release: Deepstream 3.0","description":"a foundation for a multi-protocol-server","leaf":true,"order":20170721,"":{"order":100}},"release-clientjs-4.0":{"slug":"/blog/20190730-release-clientjs-4.0/","title":"Release: Javascript/Node 4.0","description":"The newly improved Typescript and ES6 SDK","leaf":true,"order":20190730,"":{"order":100}},"release-deepstream-4.1":{"slug":"/blog/20190830-release-deepstream-4.1/","title":"Release: Deepstream 4.1","description":"Deepstream V3 and below compatibility support!","leaf":true,"order":20190830,"":{"order":100}},"release-clientjs-4.1":{"slug":"/blog/20190905-release-clientjs-4.1/","title":"Release: Javascript/Node 4.1","description":"Default Timer Implementation","leaf":true,"order":20190905,"":{"order":100}},"release-deepstream-4.2":{"slug":"/blog/20190909-release-deepstream-4.2/","title":"Release: Deepstream 4.2","description":"MQTT AND JSON Protocol support!","leaf":true,"order":20190909,"":{"order":100}},"release-clientjs-5.0":{"slug":"/blog/20190920-release-clientjs-5.0/","title":"Release: Javascript/Node 5.0","description":"Better Typescript and MIT","leaf":true,"order":20190920,"":{"order":100}},"release-deepstream-5.0":{"slug":"/blog/20190920-release-deepstream-5.0/","title":"Release: Deepstream 5.0","description":"The MIT Resurrection","leaf":true,"order":20190920,"":{"order":100}},"realtime-search":{"slug":"/blog/20191104-realtime-search/","title":"Realtime Search","description":"The Realtime Search Evolution","leaf":true,"order":20191104,"":{"order":100}},"release-deepstream-4.0":{"slug":"/blog/20190730-release-deepstream-4.0/","title":"Release: Deepstream 4.0","description":"The massively upgraded deepstream server! Introducing too many changes to be contained within a description!","leaf":true,"order":20190730,"":{"order":100}}}}}}